{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect, useContext, useRef } from \"react\";\nimport * as Notifications from \"expo-notifications\";\nimport Storage from \"../../helpers/localStorage\";\nimport StoreContext from \"../../helpers/globalStates\";\nimport { SettingNotifications } from \"../../helpers/validatePushToken\";\nimport MainStack from \"./MainStack\";\nimport LoadStack from \"./LoadStack\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar AppNavigator = function AppNavigator(_ref) {\n  var TabBottom = _ref.TabBottom;\n\n  var _useContext = useContext(StoreContext.SecurityContext),\n      _setJwt = _useContext._setJwt;\n\n  var _useState = useState(\"Initial\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      redirect = _useState2[0],\n      setRedirect = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      finished = _useState4[0],\n      setFinished = _useState4[1];\n\n  var notificationListener = useRef();\n  var responseListener = useRef();\n  useEffect(function () {\n    setTimeout(function () {\n      SettingNotifications();\n      VerifySession();\n    }, 2000);\n    notificationListener.current = Notifications.addNotificationReceivedListener(function (notification) {});\n    responseListener.current = Notifications.addNotificationResponseReceivedListener(function (response) {});\n    return function () {\n      Notifications.removeNotificationSubscription(notificationListener.current);\n      Notifications.removeNotificationSubscription(responseListener.current);\n    };\n  }, []);\n\n  var VerifySession = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var token = yield Storage.getItem(\"_TOKEN_API\");\n        var response = token && token.length > 0 ? true : false;\n\n        if (response) {\n          _setJwt(token);\n\n          setRedirect(\"Home\");\n          setFinished(true);\n        } else {\n          setFinished(true);\n        }\n      } catch (error) {\n        setFinished(true);\n      }\n    });\n\n    return function VerifySession() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  if (!finished) {\n    return _jsx(LoadStack, {});\n  }\n\n  return _jsx(MainStack, {\n    TabBottom: TabBottom,\n    redirect: redirect\n  });\n};\n\nexport default AppNavigator;","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","Notifications","Storage","StoreContext","SettingNotifications","MainStack","LoadStack","AppNavigator","TabBottom","SecurityContext","_setJwt","redirect","setRedirect","finished","setFinished","notificationListener","responseListener","setTimeout","VerifySession","current","addNotificationReceivedListener","notification","addNotificationResponseReceivedListener","response","removeNotificationSubscription","token","getItem","length","error"],"sources":["/Users/andresfelipepinillameneses/Documents/John 2/front/src/navigation/StackTabs/index.js"],"sourcesContent":["import React, { useState, useEffect, useContext, useRef } from \"react\";\n\nimport * as Notifications from \"expo-notifications\";\n\nimport Storage from \"../../helpers/localStorage\";\nimport StoreContext from \"../../helpers/globalStates\";\nimport { SettingNotifications } from \"../../helpers/validatePushToken\";\n\nimport MainStack from \"./MainStack\";\nimport LoadStack from \"./LoadStack\";\n\nconst AppNavigator = ({ TabBottom }) => {\n  const { _setJwt } = useContext(StoreContext.SecurityContext);\n\n  const [redirect, setRedirect] = useState(\"Initial\");\n  const [finished, setFinished] = useState(false);\n\n  const notificationListener = useRef();\n  const responseListener = useRef();\n\n  useEffect(() => {\n    setTimeout(() => {\n      SettingNotifications();\n      VerifySession();\n    }, 2000);\n\n    // Este escucha está activo cuando una notificación\n    // es recibida con la App en primer plano\n    notificationListener.current =\n      Notifications.addNotificationReceivedListener((notification) => {});\n\n    // Este escucha es disparado cuando un usuario interactua con una notificación con la App en primer o segundo plano\n    responseListener.current =\n      Notifications.addNotificationResponseReceivedListener((response) => {});\n\n    return () => {\n      Notifications.removeNotificationSubscription(\n        notificationListener.current\n      );\n      Notifications.removeNotificationSubscription(responseListener.current);\n    };\n  }, []);\n\n  const VerifySession = async () => {\n    try {\n      // await Storage.clearAll();\n      let token = await Storage.getItem(\"_TOKEN_API\");\n      let response = token && token.length > 0 ? true : false;\n      // console.log( {token}, {response} );\n      if (response) {\n        _setJwt(token);\n        setRedirect(\"Home\");\n        setFinished(true);\n      } else {\n        setFinished(true);\n      }\n    } catch (error) {\n      // Error retrieving data\n      // console.log(error);\n      setFinished(true);\n    }\n  };\n\n  if (!finished) {\n    return <LoadStack />;\n  }\n\n  return <MainStack TabBottom={TabBottom} redirect={redirect} />;\n};\n\nexport default AppNavigator;\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,EAAiDC,MAAjD,QAA+D,OAA/D;AAEA,OAAO,KAAKC,aAAZ,MAA+B,oBAA/B;AAEA,OAAOC,OAAP;AACA,OAAOC,YAAP;AACA,SAASC,oBAAT;AAEA,OAAOC,SAAP;AACA,OAAOC,SAAP;;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,OAAmB;EAAA,IAAhBC,SAAgB,QAAhBA,SAAgB;;EACtC,kBAAoBT,UAAU,CAACI,YAAY,CAACM,eAAd,CAA9B;EAAA,IAAQC,OAAR,eAAQA,OAAR;;EAEA,gBAAgCb,QAAQ,CAAC,SAAD,CAAxC;EAAA;EAAA,IAAOc,QAAP;EAAA,IAAiBC,WAAjB;;EACA,iBAAgCf,QAAQ,CAAC,KAAD,CAAxC;EAAA;EAAA,IAAOgB,QAAP;EAAA,IAAiBC,WAAjB;;EAEA,IAAMC,oBAAoB,GAAGf,MAAM,EAAnC;EACA,IAAMgB,gBAAgB,GAAGhB,MAAM,EAA/B;EAEAF,SAAS,CAAC,YAAM;IACdmB,UAAU,CAAC,YAAM;MACfb,oBAAoB;MACpBc,aAAa;IACd,CAHS,EAGP,IAHO,CAAV;IAOAH,oBAAoB,CAACI,OAArB,GACElB,aAAa,CAACmB,+BAAd,CAA8C,UAACC,YAAD,EAAkB,CAAE,CAAlE,CADF;IAIAL,gBAAgB,CAACG,OAAjB,GACElB,aAAa,CAACqB,uCAAd,CAAsD,UAACC,QAAD,EAAc,CAAE,CAAtE,CADF;IAGA,OAAO,YAAM;MACXtB,aAAa,CAACuB,8BAAd,CACET,oBAAoB,CAACI,OADvB;MAGAlB,aAAa,CAACuB,8BAAd,CAA6CR,gBAAgB,CAACG,OAA9D;IACD,CALD;EAMD,CArBQ,EAqBN,EArBM,CAAT;;EAuBA,IAAMD,aAAa;IAAA,8BAAG,aAAY;MAChC,IAAI;QAEF,IAAIO,KAAK,SAASvB,OAAO,CAACwB,OAAR,CAAgB,YAAhB,CAAlB;QACA,IAAIH,QAAQ,GAAGE,KAAK,IAAIA,KAAK,CAACE,MAAN,GAAe,CAAxB,GAA4B,IAA5B,GAAmC,KAAlD;;QAEA,IAAIJ,QAAJ,EAAc;UACZb,OAAO,CAACe,KAAD,CAAP;;UACAb,WAAW,CAAC,MAAD,CAAX;UACAE,WAAW,CAAC,IAAD,CAAX;QACD,CAJD,MAIO;UACLA,WAAW,CAAC,IAAD,CAAX;QACD;MACF,CAZD,CAYE,OAAOc,KAAP,EAAc;QAGdd,WAAW,CAAC,IAAD,CAAX;MACD;IACF,CAlBkB;;IAAA,gBAAbI,aAAa;MAAA;IAAA;EAAA,GAAnB;;EAoBA,IAAI,CAACL,QAAL,EAAe;IACb,OAAO,KAAC,SAAD,KAAP;EACD;;EAED,OAAO,KAAC,SAAD;IAAW,SAAS,EAAEL,SAAtB;IAAiC,QAAQ,EAAEG;EAA3C,EAAP;AACD,CAzDD;;AA2DA,eAAeJ,YAAf"},"metadata":{},"sourceType":"module"}